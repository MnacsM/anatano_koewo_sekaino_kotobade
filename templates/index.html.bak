{% extends 'base.html' %}
{% block title %}あなたの声を世界の言葉に{% endblock %}

{% block content %}
		<div>
			<h1 class="headding03 tcenter">あなたの声を世界の言葉に<br>- コンピュータによる同時通訳 -</h1>

			<div class="box11">
				<p>
					「音声認識開始」ボタンを押してから，マイクに向かって話しかけてください．
					「単語」よりも「文」で話しかけてもらった方が良い感じに翻訳されます．
					例えば...
					<ul>
						<li>私は豊田高専のオープンキャンパスに行きました</li>
						<li>ここ数年雨模様です</li>
						<li>新型コロナウイルスの感染状況が早く落ち着くと良いと思っています</li>
					</ul>
					<span class="highlight"> どんな言葉でも結構です．お好きに話しかけ，音声認識，翻訳，音声合成を体験してみてください！！</span>
					<br><br>
				</p>
			</div>

			<div class="blueBox">
			<!-- <a href="#" class="button rosy">Button</a> -->
			<input type="button" value="音声認識開始" onclick="recognition3.start();" class="button rosy"/>
			<input type="button" value="音声認識終了" onclick="recognition3.stop();" class="button rosy"/>
			<P>
				<div id="state3">「音声認識開始」をクリックしてください</div>
			</P>
			<P>
				<div id="recognizedText3"></div>
			<P>
			</div>

			<form method="POST" action="">
				<input type="text" name="text" id="input">
				<input type="text" name="result" id="result" style="display:none">
				<input type="submit" value="翻訳" id="en" name="sub" class="button rosy">
				<input type="submit" value="通訳" id="translate" name="sub" class="button rosy" style="display:none">
				<input type="submit" value="アメリカ" id="en" name="sub" class="button rosy" style="display:none">
				<input type="text" name="en-result" id="en-result" style="display:none">
				<input type="submit" value="ドイツ" id="de" name="sub" class="button rosy" style="display:none">
				<input type="text" name="de-result" id="de-result" style="display:none">
				<input type="submit" value="スペイン" id="es" name="sub" class="button rosy" style="display:none">
				<input type="text" name="es-result" id="es-result" style="display:none">
				<input type="submit" value="フランス" id="fr" name="sub" class="button rosy" style="display:none">
				<input type="text" name="fr-result" id="fr-result" style="display:none">
				<input type="submit" value="イタリア" id="it" name="sub" class="button rosy" style="display:none">
				<input type="text" name="it-result" id="it-result" style="display:none">
				<input type="submit" value="韓国" id="ko" name="sub" class="button rosy" style="display:none">
				<input type="text" name="ko-result" id="ko-result" style="display:none">
				<input type="submit" value="中国" id="zh" name="sub" class="button rosy" style="display:none">
				<input type="text" name="zh-result" id="zh-result" style="display:none">
				<input type="submit" value="ロシア" id="ru" name="sub" class="button rosy" style="display:none">
				<input type="text" name="ru-result" id="ru-result" style="display:none">
				<input type="submit" value="タイ" id="th" name="sub" class="button rosy" style="display:none">
				<input type="text" name="th-result" id="th-result" style="display:none">
				<input type="submit" value="停止" id="stop" name="jump" class="button rosy" onClick="location.href'/'">
			</form>

			<div class="world" id="output">
				<script>
					var recognition3 = new webkitSpeechRecognition();
					recognition3.lang = "ja-JP";
					recognition3.interimResults = true;
					recognition3.continuous = true;

					var result;

					recognition3.onstart = function() {
						$("#state3").text("パソコンに向かって話しかけてください");
						console.log('on start');
					};
					recognition3.onsoundstart = function() {
						$("#state3").text("認識中");
						console.log('onsoundstart');
					};
					recognition3.onnomatch = function() {
						$("#recognizedText3").text("もう一度試してください");
					};
					recognition3.onerror= function() {
						$("#recognizedText3").text("エラー");
					};
					recognition3.onsoundend = function() {
						$("#state3").text("「音声認識開始」をクリックしてください");
					};
					recognition3.onend = function(){
						$("#state3").text("「音声認識開始」をクリックしてください");
					};
					recognition3.onresult = function(event) {
						var results = event.results;
						for (var i = event.resultIndex; i < results.length; i++) {
							if (results[i].isFinal) {
								$("#recognizedText3").text(results[i][0].transcript);
								result = results[i][0].transcript;
								document.getElementById("input").value = result;
								document.getElementById("en").click();
							} else {
								$("#recognizedText3").text(results[i][0].transcript);
							}
						}
					};
				</script>

		<!-- <?php
		// Microsoft Tranlator テキスト API を使うためのAPIキーを定数として設定
		// define('APIKEY', 'b97593de47f24e88a1000c3fc5da06b2');
		// define('APIKEY', 'f116d6f3653d41fdb4a6725fe6e1c29f');
		// define('APIKEY', '7e385348542c46b3b6537ebd2629148c');
		// define('APIKEY', '9c8d3267718848b4abf6c683cfa00610');
		define('APIKEY', '2d59041ffed9459db124d3d23f274304');
		// 取得した翻訳文字列を返すために Content-type を設定。JSON形式で返す
		header('Content-type: application/json; charset=utf-8');

		$input_text = $_POST['text'];

		$en_result = $_POST['en-result'];
		$de_result = $_POST['de-result'];
		$es_result = $_POST['es-result'];
		$fr_result = $_POST['fr-result'];
		$it_result = $_POST['it-result'];
		$ko_result = $_POST['ko-result'];
		$zh_result = $_POST['zh-result'];
		$ru_result = $_POST['ru-result'];
		$th_result = $_POST['th-result'];

		if (isset($_POST["sub"])) {
		$kbn = htmlspecialchars($_POST["sub"], ENT_QUOTES, "UTF-8");
		switch ($kbn) {
			// 本番はここから
		case "翻訳":
		$to = 'en';
		$to2 = 'en-US';

		print "<table border=\"0\">";
		print "<tr>";
		print "<td width=64 height=150>";
		print "<img src=\"picture/use/ja.png\" alt=\"サンプル\">";
		print "<div class=\"tcenter\">";
		echo "日本";
		print "</div>";
		print "</td>";
		print "<td width=700px height=80>";
		print "<div class=\"triangle-border left tleft\">";
		echo $input_text;
		print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/".$to.".png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo アメリカ;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			// 翻訳実行
		$result = getTranslation($input_text, $to);
			htmlspecialchars($result, ENT_QUOTES, 'UTF-8', false);
		echo ($result);
		//print "console.log(".$result.")";
		//
			print "</div>";
		print "</td>";
		print "</tr><tr>";
		print "\n";

		// 音声合成
			print "<script>";
			print "var msg = new SpeechSynthesisUtterance();";
			print "document.getElementById(\"input\").value =\"". $input_text. "\";";
			print "document.getElementById(\"result\").value =\"". $result. "\";";
			print "document.getElementById(\"en-result\").value =\"". $result. "\";";
			print "var voices = window.speechSynthesis.getVoices();";
		print "msg.voiceURI = 'Google 日本語';";
			print "msg.volume = 1;";
			print "msg.rate = 1;";
			print "msg.pitch = 1;";
		print "msg.lang = \"ja-JP\";";
		print "msg.text = \"" . $input_text . "\";";
		print "console.log(msg);";
		// 日本語の合成（不要と考える）
			// print "speechSynthesis.speak(msg);";

			print "var msg = new SpeechSynthesisUtterance();";
			print "document.getElementById(\"input\").value =\"". $input_text. "\";";
			print "document.getElementById(\"result\").value =\"". $result. "\";";
			print "document.getElementById(\"en-result\").value =\"". $result. "\";";
		print "window.speechSynthesis.onvoiceschanged = function() {";
		print "if (voices.length == 0){";
		print "console.log('error');";
		// なんか不具合があるので，２回voicesを取得
			print "voices = window.speechSynthesis.getVoices();\n";

		// debug用
		print "voices.forEach(function(v, i){\n";
			print "console.log(i, v.name, v.lang);\n";
		print "});\n";

			print "msg.volume = 1;";
			print "msg.rate = 1;";
			print "msg.pitch = 1;";
		print "msg.lang = '".$to2."';";
			print "msg.voice = voices[48];";
		print "msg.text = \"" . $result . "\";";
		print "console.log(msg);";
			print "speechSynthesis.speak(msg);";
		print "}";
		print "};";

			print "msg.onend = function(event){";
			print "console.log('Finished in ' + event.elapsedTime + 'seconds.');";
		print "document.getElementById(\"de\").click();";
			print "};";

			print "</script>";
			print "</tr>";
		print "</table>";

		print "<script>";
			print "</script>";

		break;

		case "ドイツ":
		$to = 'de';
		$to2 = 'de-DE';

		print "<table border=\"0\">";
		print "<tr>";
		print "<td width=64 height=150>";
		print "<img src=\"picture/use/ja.png\" alt=\"サンプル\">";
		print "<div class=\"tcenter\">";
		echo "日本";
		print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\">";
		echo $input_text;
		print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/en.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo アメリカ;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $en_result;
			print "</div>";
		print "</td>";
		print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/".$to.".png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo ドイツ;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			// 翻訳実行
		$result = getTranslation($input_text, $to);
			htmlspecialchars($result, ENT_QUOTES, 'UTF-8', false);
		echo ($result);
		//
			print "</div>";
		print "</td>";

			print "<script>";
			print "document.getElementById(\"input\").value =\"". $input_text. "\";";
			print "document.getElementById(\"result\").value =\"". $result. "\";";
			print "document.getElementById(\"en-result\").value =\"". $en_result. "\";";
			print "document.getElementById(\"de-result\").value =\"". $result. "\";";
			print "var msg = new SpeechSynthesisUtterance();";

		//print "window.speechSynthesis.onvoiceschanged = function() {";
			print "var voices = window.speechSynthesis.getVoices();";
			print "msg.voice = voices[47];";
			print "msg.volume = 1;";
			print "msg.rate = 1;";
			print "msg.pitch = 1;";
			print "msg.text = \"" . $result . "\";";
		print "msg.lang = '".$to2."';";
			print "speechSynthesis.speak(msg);";
		//print "};";


			print "msg.onend = function(event){";
			print "console.log('Finished in ' + event.elapsedTime + 'seconds.');";
		print "document.getElementById(\"es\").click();";
			print "};";

			print "</script>";
			print "</tr>";
		print "</table>";

		break;

		case "スペイン":
		$to = 'es';
		$to2 = 'es-ES';

		print "<table border=\"0\">";
		print "<tr>";
		print "<td width=64 height=150>";
		print "<img src=\"picture/use/ja.png\" alt=\"サンプル\">";
		print "<div class=\"tcenter\">";
		echo "日本";
		print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\">";
		echo $input_text;
		print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/en.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo アメリカ;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $en_result;
			print "</div>";
		print "</td>";
		print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/de.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo ドイツ;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $de_result;
			print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/".$to.".png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo スペイン;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			// 翻訳実行
		$result = getTranslation($input_text, $to);
			htmlspecialchars($result, ENT_QUOTES, 'UTF-8', false);
		echo ($result);
		//
			print "</div>";
		print "</td>";
		print "</tr><tr>";

			print "<script>";
			print "document.getElementById(\"input\").value =\"". $input_text. "\";";
			print "document.getElementById(\"result\").value =\"". $result. "\";";
			print "document.getElementById(\"en-result\").value =\"". $en_result. "\";";
			print "document.getElementById(\"de-result\").value =\"". $de_result. "\";";
			print "document.getElementById(\"es-result\").value =\"". $result. "\";";
			print "var msg = new SpeechSynthesisUtterance();";
		print "window.speechSynthesis.onvoiceschanged = function() {";
			print "var voices = window.speechSynthesis.getVoices();";
			print "msg.voice = voices[51];";
			print "msg.volume = 1;";
			print "msg.rate = 1;";
			print "msg.pitch = 1;";
			print "msg.text = \"" . $result . "\";";
		print "msg.lang = '".$to2."';";
			print "speechSynthesis.speak(msg);";
		print "};";

			print "msg.onend = function(event){";
			print "console.log('Finished in ' + event.elapsedTime + 'seconds.');";
		print "document.getElementById(\"fr\").click();";
			print "};";

			print "</script>";
			print "</tr>";
		print "</table>";

		break;

		case "フランス":
		$to = 'fr';
		$to2 = 'fr-FR';

		print "<table border=\"0\">";
		print "<tr>";
		print "<td width=64 height=150>";
		print "<img src=\"picture/use/ja.png\" alt=\"サンプル\">";
		print "<div class=\"tcenter\">";
		echo "日本";
		print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\">";
		echo $input_text;
		print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/en.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo アメリカ;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $en_result;
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/de.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo ドイツ;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $de_result;
			print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/es.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo スペイン;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $es_result;
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/".$to.".png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo フランス;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			// 翻訳実行
		$result = getTranslation($input_text, $to);
			htmlspecialchars($result, ENT_QUOTES, 'UTF-8', false);
		echo ($result);
		//
			print "</div>";
		print "</td>";

			print "<script>";
			print "document.getElementById(\"input\").value =\"". $input_text. "\";";
			print "document.getElementById(\"result\").value =\"". $result. "\";";
			print "document.getElementById(\"en-result\").value =\"". $en_result. "\";";
			print "document.getElementById(\"de-result\").value =\"". $de_result. "\";";
			print "document.getElementById(\"es-result\").value =\"". $es_result. "\";";
			print "document.getElementById(\"fr-result\").value =\"". $result. "\";";
			print "var msg = new SpeechSynthesisUtterance();";
		print "window.speechSynthesis.onvoiceschanged = function() {";
			print "var voices = window.speechSynthesis.getVoices();";
			print "msg.voice = voices[53];";
			print "msg.volume = 1;";
			print "msg.rate = 1;";
			print "msg.pitch = 1;";
			print "msg.text = \"" . $result . "\";";
		print "msg.lang = '".$to2."';";
			print "speechSynthesis.speak(msg);";
		print "};";

			print "msg.onend = function(event){";
			print "console.log('Finished in ' + event.elapsedTime + 'seconds.');";
		print "document.getElementById(\"it\").click();";
			print "};";
			print "msg.onerror = function(event){";
			print "console.log('Finished in ' + event.elapsedTime + 'seconds.');";
		print "document.getElementById(\"it\").click();";
			print "};";

			print "</script>";
			print "</tr>";
		print "</table>";

		break;

		case "イタリア":
		$to = 'it';
		$to2 = 'it-IT';

		print "<table border=\"0\">";
		print "<tr>";
		print "<td width=64 height=150>";
		print "<img src=\"picture/use/ja.png\" alt=\"サンプル\">";
		print "<div class=\"tcenter\">";
		echo "日本";
		print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\">";
		echo $input_text;
		print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/en.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo アメリカ;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $en_result;
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/de.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo ドイツ;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $de_result;
			print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/es.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo スペイン;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $es_result;
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/fr.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo フランス;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $fr_result;
			print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/".$to.".png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo イタリア;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			// 翻訳実行
		$result = getTranslation($input_text, $to);
			htmlspecialchars($result, ENT_QUOTES, 'UTF-8', false);
		echo ($result);
		//
			print "</div>";
		print "</td>";
			print "</tr><tr>";

			print "<script>";
			print "document.getElementById(\"input\").value =\"". $input_text. "\";";
			print "document.getElementById(\"result\").value =\"". $result. "\";";
			print "document.getElementById(\"en-result\").value =\"". $en_result. "\";";
			print "document.getElementById(\"de-result\").value =\"". $de_result. "\";";
			print "document.getElementById(\"es-result\").value =\"". $es_result. "\";";
			print "document.getElementById(\"fr-result\").value =\"". $fr_result. "\";";
			print "document.getElementById(\"it-result\").value =\"". $result. "\";";
			print "var msg = new SpeechSynthesisUtterance();";
		print "window.speechSynthesis.onvoiceschanged = function() {";
			print "var voices = window.speechSynthesis.getVoices();";
			print "msg.voice = voices[56];";
			print "msg.volume = 1;";
			print "msg.rate = 1;";
			print "msg.pitch = 1;";
			print "msg.text = \"" . $result . "\";";
		print "msg.lang = '".$to2."';";
			print "speechSynthesis.speak(msg);";
		print "};";

			print "msg.onend = function(event){";
			print "console.log('Finished in ' + event.elapsedTime + 'seconds.');";
		print "document.getElementById(\"ko\").click();";
			print "};";

			print "</script>";
			print "</tr>";
		print "</table>";

		break;

		case "韓国":
		$to = 'ko';
		$to2 = 'ko-KR';

		print "<table border=\"0\">";
		print "<tr>";
		print "<td width=64 height=150>";
		print "<img src=\"picture/use/ja.png\" alt=\"サンプル\">";
		print "<div class=\"tcenter\">";
		echo "日本";
		print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\">";
		echo $input_text;
		print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/en.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo アメリカ;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $en_result;
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/de.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo ドイツ;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $de_result;
			print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/es.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo スペイン;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $es_result;
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/fr.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo フランス;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $fr_result;
			print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/it.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo イタリア;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $it_result;
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/".$to.".png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo 韓国;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			// 翻訳実行
		$result = getTranslation($input_text, $to);
			htmlspecialchars($result, ENT_QUOTES, 'UTF-8', false);
		echo ($result);
		//
			print "</div>";
		print "</td>";

			print "<script>";
			print "document.getElementById(\"input\").value =\"". $input_text. "\";";
			print "document.getElementById(\"result\").value =\"". $result. "\";";
			print "document.getElementById(\"en-result\").value =\"". $en_result. "\";";
			print "document.getElementById(\"de-result\").value =\"". $de_result. "\";";
			print "document.getElementById(\"es-result\").value =\"". $es_result. "\";";
			print "document.getElementById(\"fr-result\").value =\"". $fr_result. "\";";
			print "document.getElementById(\"it-result\").value =\"". $it_result. "\";";
			print "document.getElementById(\"ko-result\").value =\"". $result. "\";";
			print "var msg = new SpeechSynthesisUtterance();";
		print "window.speechSynthesis.onvoiceschanged = function() {";
			print "var voices = window.speechSynthesis.getVoices();";
			print "msg.voice = voices[58];";
			print "msg.volume = 1;";
			print "msg.rate = 1;";
			print "msg.pitch = 1;";
			print "msg.text = \"" . $result . "\";";
		print "msg.lang = '".$to2."';";
			print "speechSynthesis.speak(msg);";
		print "};";

			print "msg.onend = function(event){";
			print "console.log('Finished in ' + event.elapsedTime + 'seconds.');";
		print "document.getElementById(\"zh\").click();";
			print "};";

			print "</script>";
			print "</tr>";
		print "</table>";

		break;

		case "中国":
		$to = 'zh-chs';
		$to2 = 'zh-CN';

		print "<table border=\"0\">";
		print "<tr>";
		print "<td width=64 height=150>";
		print "<img src=\"picture/use/ja.png\" alt=\"サンプル\">";
		print "<div class=\"tcenter\">";
		echo "日本";
		print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\">";
		echo $input_text;
		print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/en.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo アメリカ;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $en_result;
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/de.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo ドイツ;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $de_result;
			print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/es.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo スペイン;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $es_result;
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/fr.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo フランス;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $fr_result;
			print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/it.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo イタリア;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $it_result;
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/ko.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo 韓国;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $ko_result;
			print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/".$to.".png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo 中国;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			// 翻訳実行
		$result = getTranslation($input_text, $to);
			htmlspecialchars($result, ENT_QUOTES, 'UTF-8', false);
		echo ($result);
		//
		print($result_array);
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		if(strcmp($to, "de") == 0 or strcmp($to, "fr") == 0 or strcmp($to, "ko") == 0){
			print "</tr><tr>";
			}

			print "<script>";
			print "document.getElementById(\"input\").value =\"". $input_text. "\";";
			print "document.getElementById(\"result\").value =\"". $result. "\";";
			print "document.getElementById(\"en-result\").value =\"". $en_result. "\";";
			print "document.getElementById(\"de-result\").value =\"". $de_result. "\";";
			print "document.getElementById(\"es-result\").value =\"". $es_result. "\";";
			print "document.getElementById(\"fr-result\").value =\"". $fr_result. "\";";
			print "document.getElementById(\"it-result\").value =\"". $it_result. "\";";
			print "document.getElementById(\"ko-result\").value =\"". $ko_result. "\";";
			print "document.getElementById(\"zh-result\").value =\"". $result. "\";";
			print "var msg = new SpeechSynthesisUtterance();";
		print "window.speechSynthesis.onvoiceschanged = function() {";
			print "var voices = window.speechSynthesis.getVoices();";
			print "msg.voice = voices[63];";
			print "msg.volume = 1;";
			print "msg.rate = 1;";
			print "msg.pitch = 1;";
			print "msg.text = \"" . $result . "\";";
		print "msg.lang = '".$to2."';";
			print "speechSynthesis.speak(msg);";
		print "};";

			print "msg.onend = function(e){";
			print "console.log('Finished in ' + event.elapsedTime + 'seconds.');";
		print "document.getElementById(\"ru\").click();";
			print "};";

			print "</script>";
			print "</tr>";
		print "</table>";

		break;

		case "ロシア":
		$to = 'ru';
		$to2 = 'ru-RU';

		print "<table border=\"0\">";
		print "<tr>";
		print "<td width=64 height=150>";
		print "<img src=\"picture/use/ja.png\" alt=\"サンプル\">";
		print "<div class=\"tcenter\">";
		echo "日本";
		print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\">";
		echo $input_text;
		print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/en.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo アメリカ;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $en_result;
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/de.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo ドイツ;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $de_result;
			print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/es.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo スペイン;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $es_result;
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/fr.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo フランス;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $fr_result;
			print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/it.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo イタリア;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $it_result;
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/ko.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo 韓国;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $ko_result;
			print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/zh-chs.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo 中国;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $zh_result;
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/".$to.".png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo ロシア;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			// 翻訳実行
		$result = getTranslation($input_text, $to);
			htmlspecialchars($result, ENT_QUOTES, 'UTF-8', false);
		echo ($result);
		//
		print($result_array);
			print "</div>";
		print "</td>";
			print "</tr><tr>";

			print "<script>";
			print "document.getElementById(\"input\").value =\"". $input_text. "\";";
			print "document.getElementById(\"result\").value =\"". $result. "\";";
			print "document.getElementById(\"en-result\").value =\"". $en_result. "\";";
			print "document.getElementById(\"de-result\").value =\"". $de_result. "\";";
			print "document.getElementById(\"es-result\").value =\"". $es_result. "\";";
			print "document.getElementById(\"fr-result\").value =\"". $fr_result. "\";";
			print "document.getElementById(\"it-result\").value =\"". $it_result. "\";";
			print "document.getElementById(\"ko-result\").value =\"". $ko_result. "\";";
			print "document.getElementById(\"zh-result\").value =\"". $zh_result. "\";";
			print "document.getElementById(\"ru-result\").value =\"". $result. "\";";
			print "var msg = new SpeechSynthesisUtterance();";
		print "window.speechSynthesis.onvoiceschanged = function() {";
			print "var voices = window.speechSynthesis.getVoices();";
			print "msg.voice = voices[27];";
			print "msg.volume = 1;";
			print "msg.rate = 1;";
			print "msg.pitch = 1;";
			print "msg.text = \"" . $result . "\";";
		print "msg.lang = '".$to2."';";
			print "speechSynthesis.speak(msg);";
		print "};";

			print "msg.onend = function(e){";
			print "console.log('Finished in ' + event.elapsedTime + 'seconds.');";
		print "document.getElementById(\"th\").click();";
			print "};";

			print "</script>";
			print "</tr>";
		print "</table>";

		break;

		case "タイ":
		$to = 'th';
		$to2 = 'th-TH';

		print "<table border=\"0\">";
		print "<tr>";
		print "<td width=64 height=150>";
		print "<img src=\"picture/use/ja.png\" alt=\"サンプル\">";
		print "<div class=\"tcenter\">";
		echo "日本";
		print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\">";
		echo $input_text;
		print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/en.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo アメリカ;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $en_result;
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/de.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo ドイツ;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $de_result;
			print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/es.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo スペイン;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $es_result;
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/fr.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo フランス;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $fr_result;
			print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/it.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo イタリア;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $it_result;
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/ko.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo 韓国;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $ko_result;
			print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/zh-chs.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo 中国;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $zh_result;
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/ru.png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo ロシア;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			echo $ru_result;
			print "</div>";
		print "</td>";

		print "<td width=64 height=150>";
		print "<img src=\"picture/use/".$to.".png\" alt=\"サンプル\">";
			print "<div class=\"tcenter\">";
			echo タイ;
			print "</div>";
		print "</td>";
		print "<td width=700px>";
		print "<div class=\"triangle-border left tleft\" id=\"".$to."\">";
			// 翻訳実行
		$result = getTranslation($input_text, $to);
			htmlspecialchars($result, ENT_QUOTES, 'UTF-8', false);
		echo ($result);
		//
		print($result_array);
			print "</div>";
		print "</td>";
			print "</tr><tr>";

		if(strcmp($to, "de") == 0 or strcmp($to, "fr") == 0 or strcmp($to, "ko") == 0 or strcmp($to, "ru") == 0){
			print "</tr><tr>";
			}

			print "<script>";
			print "document.getElementById(\"input\").value =\"". $input_text. "\";";
			print "document.getElementById(\"result\").value =\"". $result. "\";";
			print "document.getElementById(\"en-result\").value =\"". $en_result. "\";";
			print "document.getElementById(\"de-result\").value =\"". $de_result. "\";";
			print "document.getElementById(\"es-result\").value =\"". $es_result. "\";";
			print "document.getElementById(\"fr-result\").value =\"". $fr_result. "\";";
			print "document.getElementById(\"it-result\").value =\"". $it_result. "\";";
			print "document.getElementById(\"ko-result\").value =\"". $ko_result. "\";";
			print "document.getElementById(\"zh-result\").value =\"". $zh_result. "\";";
			print "document.getElementById(\"ru-result\").value =\"". $ru_result. "\";";
			print "document.getElementById(\"th-result\").value =\"". $result. "\";";
			print "var msg = new SpeechSynthesisUtterance();";
		print "window.speechSynthesis.onvoiceschanged = function() {";
			print "var voices = window.speechSynthesis.getVoices();";
			print "msg.voice = voices[17];";
			print "msg.volume = 1;";
			print "msg.rate = 1;";
			print "msg.pitch = 1;";
			print "msg.text = \"" . $result . "\";";
		print "msg.lang = '".$to2."';";
			print "speechSynthesis.speak(msg);";
		print "};";

			print "msg.onend = function(e){";
			print "console.log('Finished in ' + event.elapsedTime + 'seconds.');";
			print "};";

			print "</script>";
			print "</tr>";
		print "</table>";

		break;

		default:  echo "エラー"; exit;
		}
		}

		// 翻訳用関数 getTranslation　を定義
		// フォームから入力されたデータをXMLに整形して、Microsoft Translator テキスト APIへPOSTする

		function getTranslation($source, $target) {

		$token = getToken();
		$key = "Bearer" . " " . $token;
		$uri = 'https://api.microsofttranslator.com/V2/http.svc/TranslateArray';
		// $uri = 'https://api.cognitive.microsofttranslator.com/translate';

		$headers = array(
		"Authorization: " . $key,
		"Content-Type: application/xml",
		);

		// XMLでパラメーター指定

		//$word1 = htmlspecialchars($_POST['request1']);
		//$word2 = htmlspecialchars($_POST['request2']);
		$word1 = htmlspecialchars($source);

			$params = <<<EOF
	<TranslateArrayRequest>
	<AppId />
	<Texts>
		<string xmlns="http://schemas.microsoft.com/2003/10/Serialization/Arrays">$word1</string>
		</Texts>
	<To>$target</To>
	</TranslateArrayRequest>

	EOF;

			$ch = curl_init();

			curl_setopt($ch, CURLOPT_POSTFIELDS, $params);
			curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
			curl_setopt($ch, CURLOPT_URL, $uri);
			curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

			$html =  curl_exec($ch);

			curl_close($ch);

			// SimpleXMLElementを利用してオブジェクト生成
			$data = new SimpleXMLElement($html);


			// 翻訳結果をJSONデータに変換してフォーム画面へ返す
			$result = $data->TranslateArrayResponse[0]->TranslatedText;
			return $result;
			}

			// Microsoft Tranlator テキスト APIを利用するためのトークンを取得する関数
			function getToken(){
				$headers = array(
				"Content-Type: application/json",
				"Accept: application/jwt",
				"Ocp-Apim-Subscription-Key: " . APIKEY,
				"Content-Length:0"
				);

			$url     = "https://japaneast.api.cognitive.microsoft.com/sts/v1.0/issueToken";
			$ch      = curl_init();

			curl_setopt($ch, CURLOPT_POST, true);
			curl_setopt($ch, CURLOPT_URL, $url);
			curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
			curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

			$html = curl_exec($ch);

			return $html;
			curl_close($ch);
			}

		?> -->

			</div>
			<script type="text/javascript" src="/static/js/hatenablog.com.js"></script>
			<div id="copy">Copyright (C) <a href="/">Masaki MURATA</a>. All Rights Reserverd.</div>
		</div>
{% endblock %}


(index):273 1 'Alice' 'it-IT'
(index):273 2 'Alva' 'sv-SE'
(index):273 3 'Amelie' 'fr-CA'
(index):273 4 'Anna' 'de-DE'
(index):273 5 'Carmit' 'he-IL'
(index):273 6 'Damayanti' 'id-ID'
(index):273 7 'Daniel' 'en-GB'
(index):273 8 'Diego' 'es-AR'
(index):273 9 'Ellen' 'nl-BE'
(index):273 10 'Fiona' 'en'
(index):273 11 'Fred' 'en-US'
(index):273 12 'Ioana' 'ro-RO'
(index):273 13 'Joana' 'pt-PT'
(index):273 14 'Jorge' 'es-ES'
(index):273 15 'Juan' 'es-MX'
(index):273 16 'Kanya' 'th-TH'
(index):273 17 'Karen' 'en-AU'
(index):273 18 'Kyoko' 'ja-JP'
(index):273 19 'Laura' 'sk-SK'
(index):273 20 'Lekha' 'hi-IN'
(index):273 21 'Luca' 'it-IT'
(index):273 22 'Luciana' 'pt-BR'
(index):273 23 'Maged' 'ar-SA'
(index):273 24 'Mariska' 'hu-HU'
(index):273 25 'Mei-Jia' 'zh-TW'
(index):273 26 'Melina' 'el-GR'
(index):273 27 'Milena' 'ru-RU'
(index):273 28 'Moira' 'en-IE'
(index):273 29 'Monica' 'es-ES'
(index):273 30 'Nora' 'nb-NO'
(index):273 31 'Paulina' 'es-MX'
(index):273 32 'Rishi' 'en-IN'
(index):273 33 'Samantha' 'en-US'
(index):273 34 'Sara' 'da-DK'
(index):273 35 'Satu' 'fi-FI'
(index):273 36 'Sin-ji' 'zh-HK'
(index):273 37 'Tessa' 'en-ZA'
(index):273 38 'Thomas' 'fr-FR'
(index):273 39 'Ting-Ting' 'zh-CN'
(index):273 40 'Veena' 'en-IN'
(index):273 41 'Victoria' 'en-US'
(index):273 42 'Xander' 'nl-NL'
(index):273 43 'Yelda' 'tr-TR'
(index):273 44 'Yuna' 'ko-KR'
(index):273 45 'Yuri' 'ru-RU'
(index):273 46 'Zosia' 'pl-PL'
(index):273 47 'Zuzana' 'cs-CZ'
(index):273 48 'Google Deutsch' 'de-DE'
(index):273 49 'Google US English' 'en-US'
(index):273 50 'Google UK English Female' 'en-GB'
(index):273 51 'Google UK English Male' 'en-GB'
(index):273 52 'Google español' 'es-ES'
(index):273 53 'Google español de Estados Unidos' 'es-US'
(index):273 54 'Google français' 'fr-FR'
(index):273 55 'Google हिन्दी' 'hi-IN'
(index):273 56 'Google Bahasa Indonesia' 'id-ID'
(index):273 57 'Google italiano' 'it-IT'
(index):273 58 'Google 日本語' 'ja-JP'
(index):273 59 'Google 한국의' 'ko-KR'
(index):273 60 'Google Nederlands' 'nl-NL'
(index):273 61 'Google polski' 'pl-PL'
(index):273 62 'Google português do Brasil' 'pt-BR'
(index):273 63 'Google русский' 'ru-RU'
(index):273 64 'Google 普通话（中国大陆）' 'zh-CN'
(index):273 65 'Google 粤語（香港）' 'zh-HK'
(index):273 66 'Google 國語（臺灣）' 'zh-TW'
